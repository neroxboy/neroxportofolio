{"ast":null,"code":"const axios = require('axios');\nconst fs = require('browserify-fs');\nconst path = require('path-browserify');\nconst {\n  v4: uuidv4\n} = require('uuid');\nconst {\n  Fullname,\n  ownernumber\n} = require('./settings'); // Adjusted import path\n\n// Konstanta\nconst SESSION_DIR = './sessions';\nconst SYSTEM_PROMPT = {\n  role: \"system\",\n  content: `Kamu adalah ${Fullname} ðŸŒŸ, asisten cerdas dari NEROXOFFC. Versi 1.0. Tugasmu adalah memberikan jawaban yang selalu berbeda untuk setiap pengguna, meskipun pertanyaannya sama. Jangan lupa untuk menggunakan penebalan pada poin penting dan menyebut nama pengguna jika tersedia. Jaga setiap interaksi tetap segar dan unik!, dan jika bertanya soal owner kamu ${ownernumber} adalah nomornya, dan pencipta asli kamu adalah Nerox.`\n};\nconst DEBUG = true;\n\n// Fungsi Utilitas\nfunction ensureSessionDir() {\n  if (!fs.existsSync(SESSION_DIR)) fs.mkdirSync(SESSION_DIR);\n}\nfunction getSessionPath(sessionId) {\n  return path.join(SESSION_DIR, `session-${sessionId}.json`);\n}\nfunction loadSession(sessionId) {\n  try {\n    const data = fs.readFileSync(getSessionPath(sessionId), 'utf8');\n    return JSON.parse(data);\n  } catch {\n    return {\n      history: [SYSTEM_PROMPT]\n    };\n  }\n}\nfunction saveSession(sessionId, history) {\n  fs.writeFileSync(getSessionPath(sessionId), JSON.stringify({\n    history\n  }, null, 2), 'utf8');\n}\nfunction formatResponse(response) {\n  if (!response) return \"Maaf, saya tidak dapat memberikan jawaban saat ini.\";\n  response = response.replace(/Generated by BLACKBOX\\.AI, try unlimited chat https:\\/\\/www\\.blackbox\\.ai/g, '');\n  return response.trim().replace(/\\*\\*([^\\*]+)\\*\\*/g, \"*$1*\");\n}\n\n// Fungsi Utama Chat\nasync function chat(userMessage, sessionHistory) {\n  const body = {\n    messages: [SYSTEM_PROMPT, ...sessionHistory, {\n      content: userMessage,\n      role: \"user\"\n    }],\n    agentMode: \"gpt-4o\",\n    clickedAnswer2: false,\n    clickedAnswer3: false,\n    codeModelMode: true,\n    githubToken: null,\n    isChromeExt: false,\n    isMicMode: false,\n    previewToken: true,\n    trendingAgentMode: {},\n    visitFromDelta: null\n  };\n  const headers = {\n    'Content-Type': 'application/json',\n    'X-Model': 'gpt-4o'\n  };\n  let attempts = 0;\n  while (true) {\n    try {\n      attempts++;\n      if (DEBUG) console.log(`Percobaan ke-${attempts}`);\n      const response = await axios.post('https://api.blackbox.ai/api/chat', body, {\n        headers\n      });\n      if (response.data) {\n        if (DEBUG) console.log(\"Respons API diterima:\", response.data);\n        return formatResponse(response.data.replace(/(\\$\\@\\$.*?\\$\\@\\$)/g, ''));\n      }\n    } catch (error) {\n      if (DEBUG) console.error(`Mohon maaf ada kesalahan ke-${attempts}:`, error.message);\n    }\n  }\n}\n\n// Fungsi Auto Reply AI\nconst autoReplySky = async (m, skybreaker) => {\n  try {\n    const userMessage = m.text;\n    const sessionId = m.sender || uuidv4();\n    ensureSessionDir();\n    const session = loadSession(sessionId);\n    const response = await chat(userMessage, session.history);\n\n    // Use skybreaker.sendMessage directly\n    await skybreaker.sendMessage(m.chat, {\n      text: response,\n      quoted: m\n    }, {\n      ephemeral: false\n    });\n    session.history.push({\n      role: \"user\",\n      content: userMessage\n    });\n    session.history.push({\n      role: \"assistant\",\n      content: response\n    });\n    saveSession(sessionId, session.history);\n  } catch (error) {\n    console.error(\"Error saat memproses Auto Reply AI:\", error.message);\n  }\n};\n\n// Fungsi Utama Module\nmodule.exports = {\n  autoAI: async function (m, args) {\n    const userMessage = m.text;\n    if (!userMessage || /^[.$/#@$]/.test(userMessage)) return false;\n    await autoReplySky(m);\n  },\n  autoReplySky,\n  chat\n};","map":{"version":3,"names":["axios","require","fs","path","v4","uuidv4","Fullname","ownernumber","SESSION_DIR","SYSTEM_PROMPT","role","content","DEBUG","ensureSessionDir","existsSync","mkdirSync","getSessionPath","sessionId","join","loadSession","data","readFileSync","JSON","parse","history","saveSession","writeFileSync","stringify","formatResponse","response","replace","trim","chat","userMessage","sessionHistory","body","messages","agentMode","clickedAnswer2","clickedAnswer3","codeModelMode","githubToken","isChromeExt","isMicMode","previewToken","trendingAgentMode","visitFromDelta","headers","attempts","console","log","post","error","message","autoReplySky","m","skybreaker","text","sender","session","sendMessage","quoted","ephemeral","push","module","exports","autoAI","args","test"],"sources":["C:/Users/vanitas/Downloads/tesskil/src/ChatRoom.js"],"sourcesContent":["const axios = require('axios');\r\nconst fs = require('browserify-fs');\r\nconst path = require('path-browserify');\r\nconst { v4: uuidv4 } = require('uuid');\r\nconst { Fullname, ownernumber } = require('./settings'); // Adjusted import path\r\n\r\n// Konstanta\r\nconst SESSION_DIR = './sessions';\r\nconst SYSTEM_PROMPT = {\r\n    role: \"system\",\r\n    content: `Kamu adalah ${Fullname} ðŸŒŸ, asisten cerdas dari NEROXOFFC. Versi 1.0. Tugasmu adalah memberikan jawaban yang selalu berbeda untuk setiap pengguna, meskipun pertanyaannya sama. Jangan lupa untuk menggunakan penebalan pada poin penting dan menyebut nama pengguna jika tersedia. Jaga setiap interaksi tetap segar dan unik!, dan jika bertanya soal owner kamu ${ownernumber} adalah nomornya, dan pencipta asli kamu adalah Nerox.`\r\n};\r\nconst DEBUG = true;\r\n\r\n// Fungsi Utilitas\r\nfunction ensureSessionDir() {\r\n    if (!fs.existsSync(SESSION_DIR)) fs.mkdirSync(SESSION_DIR);\r\n}\r\n\r\nfunction getSessionPath(sessionId) {\r\n    return path.join(SESSION_DIR, `session-${sessionId}.json`);\r\n}\r\n\r\nfunction loadSession(sessionId) {\r\n    try {\r\n        const data = fs.readFileSync(getSessionPath(sessionId), 'utf8');\r\n        return JSON.parse(data);\r\n    } catch {\r\n        return { history: [SYSTEM_PROMPT] };\r\n    }\r\n}\r\n\r\nfunction saveSession(sessionId, history) {\r\n    fs.writeFileSync(getSessionPath(sessionId), JSON.stringify({ history }, null, 2), 'utf8');\r\n}\r\n\r\nfunction formatResponse(response) {\r\n    if (!response) return \"Maaf, saya tidak dapat memberikan jawaban saat ini.\";\r\n    response = response.replace(/Generated by BLACKBOX\\.AI, try unlimited chat https:\\/\\/www\\.blackbox\\.ai/g, '');\r\n    return response.trim().replace(/\\*\\*([^\\*]+)\\*\\*/g, \"*$1*\");\r\n}\r\n\r\n// Fungsi Utama Chat\r\nasync function chat(userMessage, sessionHistory) {\r\n    const body = {\r\n        messages: [\r\n            SYSTEM_PROMPT,\r\n            ...sessionHistory,\r\n            { content: userMessage, role: \"user\" }\r\n        ],\r\n        agentMode: \"gpt-4o\",\r\n        clickedAnswer2: false,\r\n        clickedAnswer3: false,\r\n        codeModelMode: true,\r\n        githubToken: null,\r\n        isChromeExt: false,\r\n        isMicMode: false,\r\n        previewToken: true,\r\n        trendingAgentMode: {},\r\n        visitFromDelta: null\r\n    };\r\n\r\n    const headers = {\r\n        'Content-Type': 'application/json',\r\n        'X-Model': 'gpt-4o'\r\n    };\r\n\r\n    let attempts = 0;\r\n    while (true) {\r\n        try {\r\n            attempts++;\r\n            if (DEBUG) console.log(`Percobaan ke-${attempts}`);\r\n\r\n            const response = await axios.post('https://api.blackbox.ai/api/chat', body, { headers });\r\n            if (response.data) {\r\n                if (DEBUG) console.log(\"Respons API diterima:\", response.data);\r\n                return formatResponse(response.data.replace(/(\\$\\@\\$.*?\\$\\@\\$)/g, ''));\r\n            }\r\n        } catch (error) {\r\n            if (DEBUG) console.error(`Mohon maaf ada kesalahan ke-${attempts}:`, error.message);\r\n        }\r\n    }\r\n}\r\n\r\n// Fungsi Auto Reply AI\r\nconst autoReplySky = async (m, skybreaker) => {\r\n    try {\r\n        const userMessage = m.text;\r\n        const sessionId = m.sender || uuidv4();\r\n        ensureSessionDir();\r\n        const session = loadSession(sessionId);\r\n\r\n        const response = await chat(userMessage, session.history);\r\n\r\n        // Use skybreaker.sendMessage directly\r\n        await skybreaker.sendMessage(m.chat, {\r\n            text: response,\r\n            quoted: m\r\n        }, { ephemeral: false });\r\n\r\n        session.history.push({ role: \"user\", content: userMessage });\r\n        session.history.push({ role: \"assistant\", content: response });\r\n        saveSession(sessionId, session.history);\r\n    } catch (error) {\r\n        console.error(\"Error saat memproses Auto Reply AI:\", error.message);\r\n    }\r\n};\r\n\r\n// Fungsi Utama Module\r\nmodule.exports = {\r\n    autoAI: async function (m, args) {\r\n        const userMessage = m.text;\r\n\r\n        if (!userMessage || /^[.$/#@$]/.test(userMessage)) return false;\r\n\r\n        await autoReplySky(m);\r\n    },\r\n    autoReplySky,\r\n    chat\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}